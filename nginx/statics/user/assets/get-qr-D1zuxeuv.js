import{j as e,b as d,u as p,r as a,p as i}from"./index-ktjJghY_.js";import{P as u,C as f}from"./circle-gradation-CQGXmxLK.js";import{B as j}from"./button-BqE4EY_v.js";import"./index-BV_IynQ4.js";const h="/user/assets/qr-piece1-DtKKOG5S.svg",g="/user/assets/qr-piece2-736Cc4ub.svg",N="/user/assets/qr-piece3-D-zOxFs-.svg",v={1:h,2:g,3:N},y=({pieceId:t,className:r})=>e.jsx("div",{className:`flex justify-center ${r} mx-auto h-48 w-48`,children:e.jsx("img",{src:v[t],alt:"qr欠片画像",className:"object-fit rotate-12"})}),C="/user/assets/qr-pieces-B0HvgZkZ.svg",q=()=>{const t=d(),r=p(),[o,l]=a.useState(0),[n,m]=a.useState(null);a.useEffect(()=>{try{const s=typeof t.state=="string"?JSON.parse(t.state):t.state;if(s&&typeof s=="object"&&"msg"in s&&typeof s.msg=="object"&&"NextNum"in s.msg&&typeof s.msg.NextNum=="number")m(s),l(s.msg.CleardFloor.length);else if(s&&typeof s=="object")if((s==null?void 0:s.NextNum)!==void 0){const c=s.CleardFloor??[];Array.isArray(c)?l(c.length):console.error("CleardFloor is not an array:",c)}else console.error("Invalid state structure:",s);else console.error("Unsupported location.state type:",s)}catch(s){console.error("Error parsing location state:",s)}},[t.state]),a.useEffect(()=>{if(o===3){const s=setTimeout(()=>{r(i.app.completedQr.getHref())},3e3);return()=>clearTimeout(s)}},[o,r]);const x=()=>{console.log("states-g:",n),r(i.app.map.getHref(),{replace:!0,state:n})};return e.jsx(u,{children:e.jsx("div",{className:"relative flex h-full justify-center pt-28 text-center",children:e.jsx(f,{children:o===3?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"font-sans text-4xl font-semibold text-white",children:[e.jsx("p",{children:"QRコードのかけらを"}),e.jsx("p",{children:"全てゲットした!"})]}),e.jsx("div",{className:"mx-auto mt-16 w-72",children:e.jsx("img",{src:C,alt:"qr欠片画像",className:"w-full"})})]}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"font-sans text-4xl font-semibold text-white",children:[e.jsx("p",{children:"QRコードのかけらを"}),e.jsx("p",{children:"ゲットした!"})]}),e.jsx(y,{pieceId:o,className:"my-12"}),e.jsxs("div",{className:"font-sans text-xl font-semibold leading-loose text-white",children:[e.jsx("p",{children:"鍵が完成するまで"}),e.jsxs("p",{children:["あと",3-o,"個かけらをゲットしないと"]}),e.jsx("p",{children:"いけないみたい..."}),e.jsx(j,{className:"mt-14",onClick:x,children:e.jsx("p",{children:"冒険を続ける"})})]})]})})})})};export{q as GetQrRoute};
